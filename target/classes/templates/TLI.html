<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
>

<head>
    <meta content="text/html" charset="UTF-8" http-equiv="Content-Type"/>
    <style type="text/css">
        .style1 {
            text-align: center;
        }

        textarea {
            resize: none;
        }
    </style>
    <meta content="Home page" name="description"/>
    <script src="/static/main.js" type="text/javascript"></script>

    <title>Home</title>
</head>

<body onload="FP_preloadImgs(/*url*/'/static/button16.jpg',/*url*/'/static/button17.jpg',/*url*/'/static/button19.jpg',/*url*/'/static/button1A.jpg',/*url*/'/static/button1C.jpg',/*url*/'/static/button1D.jpg',/*url*/'/static/button1F.jpg',/*url*/'/static/button20.jpg',/*url*/'/static/button22.jpg',/*url*/'/static/button23.jpg',/*url*/'/static/buttonE.jpg',/*url*/'/static/buttonF.jpg',/*url*/'/static/button14.jpg',/*url*/'/static/button15.jpg',/*url*/'/static/button17.jpg',/*url*/'/static/button18.jpg',/*url*/'/static/button1D.jpg',/*url*/'/static/button1E.jpg')"
      style="background-color: #CCFFFF">

<table style="width: 100%">
    <tr>
        <th class="style1" style="height: 10px">
            <form action="/profile" method="post">
                <button type="submit" style="width: 100px">Profile</button>
            </form>
            <br/>
            <form action="/diary" method="post">
                <button type="submit" style="width: 100px">Diary</button>
            </form>
            <br/>
            <form action="/Search" method="post">
                <button type="submit" style="width: 100px">Search</button>
            </form>
        </th>
        <th class="style1" style="height: 10%">
            <a href="/profile">
                <img alt="Home" height="350" longdesc="Home" src="/static/schoolimg.jpg" width="950"/></a></th>
        <th class="style1" style="height: 10px">
        </th>
    </tr>
    <tr>
        <th>
        </th>
    </tr>
    <tr>

        <td style="width: 10%">
            <textarea maxlength="11" id="CNsi" name="CNt" placeholder="Card Number" type="text" rows="1"/></textarea>
        </td>
        <td class="style1" style="width: 25%">
            <textarea ID="Nsi" placeholder="Name" style="width: 230px" type="text" rows="1"></textarea>
        </td>
        <td class="style1" style="width: 25%">
            <textarea maxlength="10" ID="BDsi" placeholder="Birthday" style="width: 130px" type="text"
                      rows="1"/></textarea>
        </td>
        <td class="style1" style="width: 25%">
            <textarea maxlength="8" ID="Dsi" placeholder="diary ID" type="text" rows="1"/></textarea>
        </td>

        <td class="style1" rowspan="2" style="width: 15%">
            <button onclick="applySearch(document.getElementById('CNsi'), document.getElementById('Nsi'), document.getElementById('BDsi'), document.getElementById('Dsi'))"
                    style="width: 100px">Search
            </button>
        </td>
    </tr>
</table>
<table id="resultTable" class="style1" border="1" style="width: 100%"></table>
<table style="width: 100%">
    <tr id="tableGenerated"></tr>
    <tr>
        <td class="style1" colspan="3" style="height: 5%">
            <hr/>
            <br/>
            Created by Péter Würfel<br/>
            No rights reserved.
        </td>
    </tr>
</table>

</body>
<script>
    function applySearch(Cn, N, Bd, D) {
        window.alert("process started")
        let CNTtd = Cn.value;
        let Ntd = N.value;
        let BDtd = Bd.value;
        let Dtd = D.value;
        let json = searchForStudent(CNTtd, Ntd, BDtd, Dtd);
        let table = createResponseTable(json);
        window.alert("generate success")
    }

    function searchForStudent(id, name, birth, diary) {
        let xhr = new XMLHttpRequest();
        let url = "/login/searchForStudent";
        xhr.open("POST", url, false);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                window.alert("response getted"+ xhr.responseText)
                let response = xhr.responseText;
                let jsonResp = JSON.parse(response);
                window.alert(jsonResp)
                createResponseTable(jsonResp);
            }
        }
        const search = {id : id, name : name, birth : birth, diary : diary};
        const data = JSON.stringify(search);
        xhr.send(data);
    }

    function createResponseTable(json) {
        var i;
        var response = json;
        window.alert(response.toString())
        var table = "<tr><th>Card Number</th><th>Name</th><th>Birth date</th><th>Diary ID</th></tr>";
        var x = response;
        for (i = 0; i < x.length; i++) {
            table += "<tr><td> " +
                x[i].id +
                "</td><td>" +
                x[i].name +
                "</td><td>" +
                x[i].sbirth +
                "</td><td>" +
                x[i].sdiaryID +
                "</td></tr>";
        }
        document.getElementById("resultTable").innerHTML =table
    }
</script>
</html>
